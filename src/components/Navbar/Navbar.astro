---
// import Logo from "../../assets/svg/Logo/rocket"; // Assuming this is a React component, we need to check it.
// If Logo is a .jsx file returning SVG, we should convert it or import it differently.
// For now, I'll assume I need to handle Logo.
import Links from "./Links.astro";
import Rocket from "../../assets/svg/Logo/rocket.astro";
---

<nav class="navbar" id="navbar">
  <div class="navbar-logo">
    <Rocket />
  </div>
  <button
    class="hamburger"
    id="hamburger-btn"
    aria-label="Toggle menu"
    style="display: none;"
  >
    <svg
      width="32"
      height="32"
      viewBox="0 0 32 32"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
      id="menu-icon"
    >
      <path d="M4 8H28" stroke="white" stroke-width="2" stroke-linecap="round"
      ></path>
      <path d="M4 16H28" stroke="white" stroke-width="2" stroke-linecap="round"
      ></path>
      <path d="M4 24H28" stroke="white" stroke-width="2" stroke-linecap="round"
      ></path>
    </svg>
  </button>

  <div id="links-container" class="links">
    <Links />
  </div>
</nav>

<script>
  const navbar = document.getElementById("navbar");
  const hamburgerBtn = document.getElementById("hamburger-btn");
  const linksContainer = document.getElementById("links-container");
  let menuOpen = false;

  function toggleMenu() {
    if (!linksContainer) return;
    menuOpen = !menuOpen;
    if (menuOpen) {
      linksContainer.classList.add("open");
      // Update SVG to X icon if needed
    } else {
      linksContainer.classList.remove("open");
    }
    // Update display style based on logic
    updateDisplay();
  }

  function updateDisplay() {
    if (!navbar || !linksContainer) return;
    const navbarWidth = navbar.offsetWidth;
    const linksWidth = linksContainer.scrollWidth;
    const isOverflowing = linksWidth > navbarWidth - 100;

    if (hamburgerBtn) {
      hamburgerBtn.style.display = isOverflowing ? "block" : "none";
    }

    if (linksContainer) {
      linksContainer.style.display =
        !isOverflowing || menuOpen ? "flex" : "none";
    }
  }

  if (hamburgerBtn) {
    hamburgerBtn.addEventListener("click", toggleMenu);
  }

  const observer = new ResizeObserver(updateDisplay);
  if (navbar) observer.observe(navbar);

  // Initial check
  updateDisplay();
</script>

<style>
  .navbar {
    height: 4rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 1rem;
    background: rgba(var(--color-2), 0.85);
    position: sticky;
    top: 0;
    z-index: 10;
    box-shadow: -2px 2px 5px 6px var(----colhex-5);
    backdrop-filter: blur(8px);
  }

  .navbar ul {
    list-style: none;
    display: flex;
    gap: 2rem; /* Increased gap for better spacing */
  }

  .navbar a {
    text-decoration: none;
    color: white;
    font-weight: 500;
    transition: color 0.3s ease;
    position: relative;
  }

  .navbar a::after {
    content: "";
    position: absolute;
    width: 0;
    height: 2px;
    bottom: -4px;
    left: 0;
    background-color: var(--colhex-4);
    transition: width 0.3s ease;
  }

  .navbar a:hover {
    color: var(--colhex-4);
  }

  .navbar a:hover::after {
    width: 100%;
  }

  .links.open {
    position: absolute;
    top: 100%;
    right: 0;
    width: 100vw;
    background: rgba(var(--color-2), 0.8);
  }

  .links.open ul {
    display: flex;
    flex-direction: column;
    margin: 2rem 0;
  }

  .hamburger {
    border: none;
    background: none;
    font: inherit;
    color: inherit;
    cursor: pointer;
  }

  .navbar-logo {
    --size: 4rem;
  }
</style>
